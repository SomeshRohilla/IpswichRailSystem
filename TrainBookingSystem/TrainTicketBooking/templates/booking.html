{% extends 'base.html' %}
{% load static %}
{% block title %}My Bookings{% endblock %}

{% block content %}

{% if messages %}
    {% for message in messages %}
        <div class="alert alert-success text-center">
            {{ message }}
        </div>
    {% endfor %}
{% endif %}

{% if not user.is_authenticated %}
    <div class="alert alert-warning text-center">
        <h4>Please login first</h4>
        <a href="{% url 'login' %}" class="btn btn-primary mt-2">Login</a>
    </div>
{% else %}

    <h2 class="mb-4">My Bookings</h2>

    {% if bookings %}
        <table class="table table-striped shadow">
            <thead class="table-dark">
                <tr>
                    <th>Train</th>
                    <th>Route</th>
                    <th>Date</th>
                    <th>Price</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for booking in bookings %}
                <tr>
                    <td>{{ booking.train.name }}</td>
                    <td>{{ booking.train.source }} → {{ booking.train.destination }}</td>
                    <td>{{ booking.train.travel_date }}</td>
                    <td>£{{ booking.train.price }}</td>
                    <td>
                        <!-- ✅ Cancel Button -->
                        <a href="{% url 'delete_booking' booking.id %}"
                           class="btn btn-danger btn-sm"
                           onclick="return confirm('Are you sure you want to cancel this booking?');">
                           Cancel
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="alert alert-info text-center">
            You have no bookings yet.
        </div>
    {% endif %}

{% endif %}

{% endblock %}
